<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ETH/BTC 套利监控</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#0b0f1a;
    color:#fff;
    text-align:center;
    padding:30px;
}

.card{
    background:#151a2b;
    border-radius:12px;
    padding:20px;
    margin:15px auto;
    width:320px;
    box-shadow:0 0 20px rgba(0,0,0,0.4);
}

.value{
    font-size:28px;
    font-weight:bold;
    margin-top:10px;
}

.good{ color:#00ff9d; }
.bad{ color:#ff4d6d; }

h1{
    margin-bottom:20px;
}
</style>

</head>
<body>

<h1>ETH / BTC 套利监控</h1>

<div class="card">
    <div>ETH 24h 涨跌</div>
    <div id="eth" class="value">--</div>
</div>

<div class="card">
    <div>BTC 24h 涨跌</div>
    <div id="btc" class="value">--</div>
</div>

<div class="card">
    <div>收益率差 (ETH - BTC)</div>
    <div id="spread" class="value">--</div>
</div>

<script>

async function checkSpread(){

    try{

        const ethRes = await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=ETHUSDT");
        const btcRes = await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT");

        const ethData = await ethRes.json();
        const btcData = await btcRes.json();

        const ethChange = parseFloat(ethData.priceChangePercent);
        const btcChange = parseFloat(btcData.priceChangePercent);

        const spread = ethChange - btcChange;

        document.getElementById("eth").innerText = ethChange.toFixed(2) + "%";
        document.getElementById("btc").innerText = btcChange.toFixed(2) + "%";

        let spreadEl = document.getElementById("spread");
        spreadEl.innerText = spread.toFixed(2) + "%";

        if(spread >= 0){
            spreadEl.className = "value good";
        }else{
            spreadEl.className = "value bad";
        }

        console.log("Spread:", spread);

        // ⭐ 超过2%就发Telegram
        if(Math.abs(spread) >= 2){

            fetch(`/api/sendAlert?text=ETH/BTC 24h差 ${spread.toFixed(2)}% | ETH:${ethChange.toFixed(2)}% BTC:${btcChange.toFixed(2)}%`);

        }

    }catch(e){
        console.log("Error:", e);
    }

}

// ⭐ 每10秒检测一次
setInterval(checkSpread, 10000);

// ⭐ 页面打开立刻检测一次
checkSpread();

</script>

</body>
</html>
