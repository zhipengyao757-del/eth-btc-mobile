<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ETH BTC Spread Monitor</title>
<style>
body{
  font-family: Arial;
  background:#0b0f14;
  color:#00ffa3;
  text-align:center;
  padding-top:40px;
}
.box{
  font-size:28px;
  margin:20px;
}
.small{
  font-size:18px;
  color:#aaa;
}
</style>
</head>

<body>

<h1>ETH / BTC 24H Spread</h1>

<div class="box">BTC 24H: <span id="btc">--</span>%</div>
<div class="box">ETH 24H: <span id="eth">--</span>%</div>
<div class="box">Spread: <span id="spread">--</span>%</div>
<div class="small">Alert Threshold: 1.8%</div>

<script>

const ALERT_THRESHOLD = 1.8;
let alertSent = false;

async function getData(){

 try{

   const btcRes = await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT");
   const btcData = await btcRes.json();
   const btc = parseFloat(btcData.priceChangePercent);

   const ethRes = await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=ETHUSDT");
   const ethData = await ethRes.json();
   const eth = parseFloat(ethData.priceChangePercent);

   const spread = eth - btc;

   document.getElementById("btc").innerText = btc.toFixed(2);
   document.getElementById("eth").innerText = eth.toFixed(2);
   document.getElementById("spread").innerText = spread.toFixed(2);

   checkAlert(spread);

 }catch(e){
   console.log(e);
 }

}

function checkAlert(spread){

 const absSpread = Math.abs(spread);

 // ‚≠ê Á™ÅÁ†¥Ëß¶Âèë
 if(absSpread >= ALERT_THRESHOLD && !alertSent){

   fetch(`/api/sendAlert?text=üö® ETH-BTC Spread Á™ÅÁ†¥ ${ALERT_THRESHOLD}% ÂΩìÂâç ${spread.toFixed(2)}%`);

   alertSent = true;
   console.log("Alert Sent");

 }

 // ‚≠ê ÂõûÂΩíÂ§ç‰Ωç
 if(absSpread < ALERT_THRESHOLD && alertSent){

   alertSent = false;
   console.log("Alert Reset");

 }

}

setInterval(getData, 10000);
getData();

</script>

</body>
</html>
